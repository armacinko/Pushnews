<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NyamanNya</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div id="push-notif">
    <div class="notif-text">
        <h4>Menu Baru Tersedia!</h4>
        <p id="notif-title-text"></p>
    </div>
    <button class="notif-btn" id="btn-open-notif">Buka</button>
</div>

<header>
    <h1>Culinaria Italia</h1>
    <p>Resep Lezat Setiap Hari</p>
</header>

<div class="container" id="feed-container">
    <p style="text-align:center;">Memuat resep lezat...</p>
</div>

<footer>&copy; 2024 nyamannya</footer>

<script>
    async function loadArticles() {
        try {
            const response = await fetch('articles.json');
            const data = await response.json();
            
            const container = document.getElementById('feed-container');
            container.innerHTML = ''; // Hapus pesan memuat

            data.forEach(item => {
                container.innerHTML += `
                <article class="article-card">
                    <a href="${item.url}" rel="nofollow">
                        <img src="${item.image}" alt="${item.title}">
                    </a>
                    <div class="article-info">
                        <h2>${item.title}</h2>
                        <p>${item.desc}</p>
                        <a href="${item.url}" class="btn-read">Baca Resep</a>
                    </div>
                </article>
                `;
            });

            // Cek Notifikasi
            const latestArticle = data[0];
            const lastId = localStorage.getItem('last_id');
            if (!lastId || parseInt(lastId) < latestArticle.id) {
                showPush(latestArticle);
            }

        } catch (e) {
            console.error("Gagal load data");
        }
    }

    function showPush(art) {
        const notif = document.getElementById('push-notif');
        document.getElementById('notif-title-text').innerText = art.title;
        
        setTimeout(() => { notif.classList.add('active'); }, 2000);

        document.getElementById('btn-open-notif').onclick = () => {
            localStorage.setItem('last_id', art.id);
            window.location.href = art.url;
        };
    }

    window.onload = loadArticles;
</script>
</body>
</html>
